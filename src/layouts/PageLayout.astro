---
import { getEntry } from 'astro:content';
import Footer from '@components/organisms/Footer.astro';
import type { NavLink } from '@components/organisms/Navigation.astro';
import Header from '@components/sections/Header.astro';
import Main from '@components/sections/Main.astro';
import BaseLayout from '@layouts/BaseLayout.astro';

// Fetch navigation data from content collections
const mainNav = await getEntry('navigation', 'main');

// Map navigation data to component format
const defaultNavLinks: NavLink[] = mainNav?.data.items.map(item => ({
  href: item.href,
  label: item.label,
})) || [];

export interface Props {
  title: string;
  description?: string;
  image?: ImageMetadata;
  navLinks?: NavLink[];
  siteName?: string;
  stickyHeader?: boolean;
  containerized?: boolean;
  maxWidth?: 'full' | '7xl' | '6xl' | '5xl' | '4xl';
  class?: string;
  padding?: boolean
}

const {
  title,
  description,
  image,
  navLinks = defaultNavLinks,
  siteName,
  stickyHeader = true,
  containerized = false,
  padding = false,
  maxWidth = '7xl',
  class: className = '',
} = Astro.props;
---

<BaseLayout title={title} description={description} image={image}>
	<slot name="head" slot="head" />

	<div class="flex min-h-screen flex-col">
		<!-- Header -->
		<Header
			links={navLinks}
			siteName={siteName}
			sticky={stickyHeader}
			transition:persist
		>
			<slot name="header-actions" slot="actions" />
		</Header>

		<!-- Main Content -->
		<Main
			containerized={containerized}
			padding={padding}
			maxWidth={maxWidth}
			class={className}
		>
			<slot />
		</Main>

		<!-- Footer -->
		<Footer class="mt-auto" transition:persist />
	</div>
</BaseLayout>
