---
import { Image } from 'astro:assets';
import ZigZagPattern from '@components/atoms/ZigZagPattern.astro';
import HouseShape from '@components/molecules/HouseShape.astro';
import type { ImageMetadata } from 'astro';

export interface Props {
  title: string;
  subtitle?: string;
  backgroundImage?: ImageMetadata | string;
  icon?: any;
  variant?: 'primary' | 'secondary' | 'supporting1' | 'supporting2' | 'speed';
  showZigZag?: boolean;
  zigZagPosition?: 'top' | 'bottom' | 'both';
  class?: string;
}

const {
  title,
  subtitle,
  backgroundImage,
  icon: Icon,
  variant = 'primary',
  showZigZag = true,
  zigZagPosition = 'both',
  class: className = ''
} = Astro.props;

const variantColors = {
  primary: {
    bg: 'bg-primary-900',
    house: 'bg-primary-700',
    text: 'text-white',
    zigzag: 'text-primary-300'
  },
  secondary: {
    bg: 'bg-secondary-900',
    house: 'bg-secondary-500',
    text: 'text-neutral-900',
    zigzag: 'text-secondary-300'
  },
  supporting1: {
    bg: 'bg-supporting1-900',
    house: 'bg-supporting1-700',
    text: 'text-white',
    zigzag: 'text-supporting1-300'
  },
  supporting2: {
    bg: 'bg-supporting2-900',
    house: 'bg-supporting2-700',
    text: 'text-neutral-900',
    zigzag: 'text-supporting2-300'
  },
  speed: {
    bg: 'bg-speed-900',
    house: 'bg-speed-700',
    text: 'text-white',
    zigzag: 'text-speed-300'
  }
};

const colors = variantColors[variant];
---

<section class={`relative w-full overflow-hidden ${colors.bg} ${className}`}>
	<!-- Background Image with Overlay -->
	{
		backgroundImage && (
			<div class="absolute inset-0 z-0">
				{typeof backgroundImage === 'string' ? (
					<img
						src={backgroundImage}
						alt=""
						class="h-full w-full object-cover opacity-20"
					/>
				) : (
					<Image
						src={backgroundImage}
						alt=""
						class="h-full w-full object-cover opacity-20"
						widths={[640, 1024, 1280, 1920]}
						sizes="100vw"
					/>
				)}
			</div>
		)
	}

	<!-- Zig-Zag Pattern Top -->
	{
		showZigZag && (zigZagPosition === 'top' || zigZagPosition === 'both') && (
			<div class="relative z-10 w-full">
				<ZigZagPattern
					width={2000}
					height={30}
					strokeWidth={4}
					color={colors.zigzag}
					class="w-full"
				/>
			</div>
		)
	}

	<!-- Content Container -->
	<div class="relative z-10 container mx-auto px-6 py-16 md:py-24">
		<div class="flex flex-col items-center justify-center">
			<!-- Icon (if provided) -->
			{
				Icon && (
					<div class={`mb-8 ${colors.text}`}>
						<Icon class="h-24 w-24 md:h-32 md:w-32" />
					</div>
				)
			}

			<!-- House-shaped Content Block -->
			<div class="w-full max-w-4xl">
				<HouseShape
					variant="standard"
					backgroundColor={colors.house}
					class="text-center"
				>
					<div class={`space-y-4 ${colors.text}`}>
						<h1 class="text-3xl font-bold md:text-5xl lg:text-6xl">
							{title}
						</h1>
						{
							subtitle && (
								<p class="mx-auto max-w-2xl text-lg opacity-90 md:text-xl lg:text-2xl">
									{subtitle}
								</p>
							)
						}

						<!-- Actions Slot -->
						<div class="pt-6">
							<slot name="actions" />
						</div>
					</div>
				</HouseShape>
			</div>
		</div>
	</div>

	<!-- Zig-Zag Pattern Bottom -->
	{
		showZigZag &&
			(zigZagPosition === 'bottom' || zigZagPosition === 'both') && (
				<div class="relative z-10 w-full">
					<ZigZagPattern
						width={2000}
						height={30}
						strokeWidth={4}
						color={colors.zigzag}
						class="w-full"
					/>
				</div>
			)
	}
</section>
